function getUrlQueryStringData(t){var e=null,n="[\\?&#]"+t+"=([^&#]*)",i=new RegExp(n),r=i.exec("?"+window.location.href.split("?")[1]);return null!=r&&(e=decodeURIComponent(r[1].replace(/\+/g," "))),e}function getVarQueryStringData(t,e){var n=null,i="[\\?&#]"+t+"=([^&#]*)",r=new RegExp(i),a=r.exec("?"+e.split("?")[1]);return null!=a&&(n=decodeURIComponent(a[1].replace(/\+/g," "))),n}$(document).on("pageshow",'div[id="articles"]',function(){var t=getUrlQueryStringData("url"),e=getUrlQueryStringData("category"),n="";e?n="http://1688.com.au/site1/news/"+e+"/index.shtml":t&&(n=t.replace(/.*site1\/news/,"http://1688.com.au/site1/news")),$.get(n,function(t){var e=$('div[id="articles"]'),i=e.children(":jqmData(role=header)"),r=e.children(":jqmData(role=content)"),a=e.children(":jqmData(role=footer)"),s="<ul data-role='listview' data-theme='c' data-dividertheme='a' data-inset='false'>",l="";navlist="",navheader="",$("div[class=listing_head]:first",t.responseText).each(function(){var t=$(this),e=t.text();e&&i.find("h1").html($.trim(e))}),$("div[class=list_nav]:first a[href]",t.responseText).each(function(){var t=$(this),e=t.attr("href");e&&(navlist+="<li><a href='articles.htm?url="+encodeURIComponent(e)+"'>",navlist+=t.text()+"</a></li>")}),$("div[class=list_nav]:first",t.responseText).each(function(){var t=$(this),e=t.text();if(e){var n=$.trim(e.split("【")[1]);n&&(navheader+="<li data-role='list-divider' style='text-align:center' role='heading'>",navheader+=n+"</li>")}}),$("div[class=content_list]:first li",t.responseText).each(function(){var t=$(this),e=$("a",t).attr("href");e&&-1==n.indexOf(e)&&(l+="<li>",l+="<a href='view.htm?url="+encodeURIComponent(e)+"'>",l+="<p>"+$("a",t).text()+"</p>",l+="<p>"+$("span",t).text()+"</p>",l+="</a>",l+="</li>")}),s+=navheader,s+=l,""!=l&&(s+=navheader),s+="</ul>",""!=navlist&&a.html("<div data-role='navbar'><ul>"+navlist+"</ul></div>"),r.html(s),e.page(),a.find(":jqmData(role=navbar)").navbar(),r.find(":jqmData(role=listview)").listview()})}),$(document).on("pageshow",'div[id="view"]',function(){var t=getUrlQueryStringData("url"),e=t?t.replace(/.*site1\/news/,"http://1688.com.au/site1/news"):"";$.get(e,function(t){var n=$('div[id="view"]'),i=n.children(":jqmData(role=header)"),r=n.children(":jqmData(role=content)"),a="<div id='turbocmscontent'>",s="";$("div[id=tit]:first, td[class=content1_3]:first",t.responseText).each(function(){var t=$(this).text();t&&i.find("h1").html($.trim(t))}),$("td[id=content]:first",t.responseText).each(function(){var t=$(this).html(),e=t.substring(t.indexOf("<!--turbocmscontentbegin-->")+27,t.indexOf("<!--turbocmscontentend-->"));a+=e}),$("div[id=content]:first",t.responseText).each(function(){$("div",$(this)).nextUntil("div[id=social_share]").each(function(){a+=$(this).html()})}),a+="</div><br><br>",$("div[class=rel] ul li a[href], td[class=content1_6] ul li a[href]",t.responseText).each(function(){var t=$(this),n=t.attr("href");n&&-1==e.indexOf(n)&&(s+="<li>",s+="<a href='view.htm?url="+encodeURIComponent(n)+"'>",s+=t.text(),s+="</a>",s+="</li>")}),a+="<ul data-role='listview' data-theme='c' data-dividertheme='a' data-inset='false'>",""!=s&&(a+="<li data-role='list-divider' role='heading'>相关文章</li>",a+=s),a+="</ul>",r.html(a),$("#turbocmscontent img").css({"max-width":"80%",height:"auto"}),$("#turbocmscontent img[src]").attr("src",function(t,n){return-1==n.indexOf("//")?"/"==n.substring(0,1)?"http://1688.com.au"+n:e.substring(0,e.lastIndexOf("/")+1)+n:n}),$("#turbocmscontent a[href]").attr("href",function(t,n){return"/site1/news/"==n.substring(0,12)||"site1/news/"==n.substring(0,11)||-1!=n.indexOf("1688.com.au/site1/news/")?-1==e.indexOf(n)?"view.htm?url="+encodeURIComponent(n):"#":-1==n.indexOf("//")&&"#"!=n.substring(0,1)?"/"==n.substring(0,1)?"http://1688.com.au"+n:e.substring(0,e.lastIndexOf("/")+1)+n:n}),$('#turbocmscontent a[href^="view.htm"]').removeAttr("target"),$("#turbocmscontent link[href]").attr("href",function(t,n){return-1==n.indexOf("//")?"/"==n.substring(0,1)?"http://1688.com.au"+n:e.substring(0,e.lastIndexOf("/")+1)+n:n}),$("#turbocmscontent script[src]").attr("src",function(t,n){return-1==n.indexOf("//")?"/"==n.substring(0,1)?"http://1688.com.au"+n:e.substring(0,e.lastIndexOf("/")+1)+n:n}),n.page(),r.find(":jqmData(role=listview)").listview()})});
